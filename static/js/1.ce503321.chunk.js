(this["webpackJsonpblogpod-web-app"]=this["webpackJsonpblogpod-web-app"]||[]).push([[1],{282:function(e,t,a){"use strict";a.r(t);var n=a(4),i=a(65),r=a(8),c=a.n(r),l=a(11),s=a(44),o=a(2),u=a(0),d=a.n(u),j=a(273),b=a(293),g=a(284),h=a(212),p=a(294),m=a(295),f=a(214),O=a(76),x=a(218),v=a(277),w=a(285),N=a(104),C=a(22),L=a(17),y=a(230),R=a(32),T=a(243),S=a.n(T),I=Object(N.a)((function(){return{root:{position:"relative"},image:{width:100,height:100,marginRight:40},close:{position:"absolute",right:40,top:-8,backgroundColor:"white",width:8,height:8,borderRadius:8,display:"block"},closeIcon:{color:"",fontSize:16}}})),k=function(e){var t=e.imageURL,a=e.onDelete,n=I();return Object(o.jsxs)("div",{className:n.root,children:[Object(o.jsx)("img",{className:n.image,src:t}),Object(o.jsx)("span",{className:n.close,onClick:a,children:Object(o.jsx)(S.a,{className:n.closeIcon})})]})},U=a(85),z=a(244),E=a.n(z),P=Object(N.a)((function(e){return{root:{borderStyle:"dashed",borderColor:e.palette.secondary.main,borderWidth:2,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",height:100,width:100,marginLeft:0},add:{fontSize:24,color:e.palette.secondary.main}}})),D=function(e){var t=P(),a=e.onClick;return Object(o.jsx)(U.a,{className:t.root,onClick:a,children:Object(o.jsx)(E.a,{className:t.add})})},A=a(256),F=a(241),q=a(274),B=a(275),H=a(276),M=a(290);var V=Object(y.b)((function(e){var t=e.errorMessage,a=e.value||"";return Object(o.jsx)(M.a,Object(n.a)(Object(n.a)({},e),{},{onChange:function(t){e.setValue(t.currentTarget.value),e.onChange&&e.onChange(t)},value:a,error:Boolean(t),helperText:t}))})),G=Object(N.a)((function(){return{imageURL:{width:"100%",marginTop:16,marginBottom:16}}})),W=function(e){var t=e.open,a=e.onCancel,n=e.onResult,i=Object(u.useState)(""),r=Object(s.a)(i,2),c=r[0],l=r[1],d=Object(u.useState)(!1),j=Object(s.a)(d,2),b=j[0],g=j[1],h=G();return Object(o.jsxs)(A.a,{open:t,children:[Object(o.jsx)(F.a,{children:"Add Image"}),Object(o.jsxs)(q.a,{children:[Object(o.jsx)(B.a,{children:"Please specify an image with 1:1 aspect ratio, that is, an image with equal width and height. This is a convenient format for mobile screens."}),Object(o.jsx)(y.a,{onValid:function(){return g(!0)},onInvalid:function(){return g(!1)},children:Object(o.jsx)(V,{name:"imageUrl",className:h.imageURL,label:"Image URL",validations:{isUrl:!0},validationErrors:{isUrl:"Please enter a valid image URL."},variant:"outlined",size:"small",value:c,onChange:function(e){l(e.target.value)},required:!0})})]}),Object(o.jsxs)(H.a,{children:[Object(o.jsx)(x.a,{onClick:a,color:"primary",children:"Cancel"}),Object(o.jsx)(x.a,{onClick:function(){n(c)},color:"primary",disabled:!b,children:"Add"})]})]})},J=[{locale:"en",title:"English"},{locale:"hi",title:"Hindi"},{locale:"bn",title:"Bengali"},{locale:"mr",title:"Marathi"},{locale:"te",title:"Telugu"},{locale:"ta",title:"Tamil"},{locale:"gu",title:"Gujarati"},{locale:"kn",title:"Kannada"},{locale:"ml",title:"Malayalam"}],K=a(27),Q=Object(N.a)((function(){return{container:{padding:32,display:"flex",flexDirection:"row",justifyContent:"center",minHeight:"calc(100vh - 64px)",width:"calc(100vw - 16px - 256px - 16px - 16px)",marginLeft:288,backgroundColor:"white",borderRadius:16},left:{display:"flex",flexDirection:"column",width:"70%"},imagesContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center"},image:{},description:{width:"100%",marginTop:40},transcript:{width:"100%",marginTop:24},descriptionInput:{lineHeight:1.8,fontSize:15},transcriptInput:{lineHeight:1.8,fontSize:15},right:{display:"flex",flexDirection:"column",marginLeft:24,flex:1},title:{width:"100%"},narrator:{width:"100%",marginTop:24},primaryImageURL:{width:"100%",marginTop:24},genderGroup:{marginTop:16},genderGroupControls:{display:"flex",flexDirection:"row"},languageCode:{marginTop:24,width:"100%"},audioPlayer:{outline:"none",marginTop:40,width:"100%"},publish:{width:"100%",marginTop:40},save:{width:"100%",marginTop:24},attachAudio:{width:"100%",marginTop:24},progress:{marginRight:8},chips:{display:"flex",flexDirection:"row",flexWrap:"wrap"},chip:{margin:2,fontSize:11},tags:{marginTop:24,width:"100%"},narratorOption:{flexDirection:"row",display:"flex",paddingTop:4,paddingBottom:4},narratorImage:{width:40,height:40,borderRadius:20},narratorTexts:{display:"flex",flexDirection:"column",marginLeft:16},narratorName:{fontSize:14,color:"#424242"},narratorUserName:{fontSize:12,color:"#9e9e9e"},articleTagImage:{width:28,height:28,borderRadius:"50%",marginRight:12},loadingArticleTags:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:56}}})),X=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(e[a]!==t[a])return!1;return!0};t.default=function(){var e=Object(L.i)(),t=Object(C.c)((function(e){return e.article})),a=t.current,r=t.uploadSignedURL,N=t.saving,T=t.publishing,S=t.generating,I=t.uploading,U=t.error,z=Object(C.c)((function(e){return e.articleTags})),E=z.list,P=z.map,A=z.fetching,F=Object(C.b)(),q=Object(u.useRef)(),B=Q(),H=Object(L.g)(),M=Object(u.useState)(""),G=Object(s.a)(M,2),Y=G[0],Z=G[1],$=Object(u.useState)(""),_=Object(s.a)($,2),ee=_[0],te=_[1],ae=Object(u.useState)(""),ne=Object(s.a)(ae,2),ie=ne[0],re=ne[1],ce=Object(u.useState)(null),le=Object(s.a)(ce,2),se=le[0],oe=le[1],ue=Object(u.useState)([]),de=Object(s.a)(ue,2),je=de[0],be=de[1],ge=Object(u.useState)("en"),he=Object(s.a)(ge,2),pe=he[0],me=he[1],fe=Object(u.useState)(!1),Oe=Object(s.a)(fe,2),xe=Oe[0],ve=Oe[1],we=Object(u.useState)(null),Ne=Object(s.a)(we,2),Ce=Ne[0],Le=Ne[1],ye=Object(u.useState)(!0),Re=Object(s.a)(ye,2),Te=Re[0],Se=Re[1],Ie=Object(u.useState)(!1),ke=Object(s.a)(Ie,2),Ue=ke[0],ze=ke[1],Ee=Object(u.useState)([]),Pe=Object(s.a)(Ee,2),De=Pe[0],Ae=Pe[1],Fe=Object(u.useState)([]),qe=Object(s.a)(Fe,2),Be=qe[0],He=qe[1],Me=Object(u.useState)(!1),Ve=Object(s.a)(Me,2),Ge=Ve[0],We=Ve[1],Je=Object(u.useState)(""),Ke=Object(s.a)(Je,2),Qe=Ke[0],Xe=Ke[1],Ye=Object(u.useState)(!1),Ze=Object(s.a)(Ye,2),$e=Ze[0],_e=Ze[1],et=Object(u.useRef)(),tt=Object(u.useRef)(),at=Object(u.useRef)(),nt=Object(u.useRef)(),it=Object(u.useRef)(),rt=Object(v.a)({matchFrom:"any",ignoreAccents:!0,ignoreCase:!0,stringify:function(e){return"".concat(e.userName," ").concat(e.firstName," ").concat(e.lastName)}}),ct=Ge&&0===Be.length;Object(u.useEffect)((function(){if(ct){var e=!0;return Object(l.a)(c.a.mark((function t(){var a,n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=[],!Qe){t.next=7;break}return t.next=4,Object(K.i)({search:Qe});case 4:n=t.sent,console.log(n),a=n.records;case 7:e&&He(a);case 8:case"end":return t.stop()}}),t)})))(),function(){e=!1}}}),[ct,Qe]),Object(u.useEffect)((function(){Ge||He([])}),[Ge]);var lt=e.id&&(null===a||void 0===a?void 0:a.id)===e.id,st=!e.id||a&&(a.transcript!==ee||a.description!==Y||a.title!==ie||a.narrator.id!==(null===se||void 0===se?void 0:se.id)||!X(a.tags,De)||!X(a.imageURLs,je)||a.languageCode!==pe);Object(u.useEffect)((function(){tt.current&&!N&&!U&&a&&H.replace("/articles/".concat(a.id,"/edit")),tt.current=N}),[a,U,H,N]),Object(u.useEffect)((function(){at.current&&!T&&U&&F(Object(R.q)(U,"ERROR")),at.current=T}),[F,U,T]),Object(u.useEffect)((function(){!e.id||a&&a.id===e.id||F(Object(R.d)({id:e.id}))}),[a,F,e.id]),Object(u.useEffect)((function(){nt.current&&!S&&!U&&r&&F(Object(R.t)(r,Ce)),nt.current&&!S&&U&&F(Object(R.q)(U,"ERROR")),nt.current=S}),[Ce,F,U,S,r]),Object(u.useEffect)((function(){var e;it.current&&!I&&(Se(!0),null===(e=q.current)||void 0===e||e.load());it.current=I}),[I]),Object(u.useEffect)((function(){lt&&(te(a.transcript),Z(a.description),re(a.title),oe(a.narrator),Ae(a.tags||[]),be(a.imageURLs),me(a.languageCode))}),[a,lt]),Object(u.useEffect)((function(){var e;null===(e=q.current)||void 0===e||e.load()}),[]),console.log(E);var ot=function(){ze(!0)},ut=function(e){return function(){var t=je.filter((function(t,a){return a!==e}));be(t)}},dt=function(e){e.target.value=null},jt=function(){var e=Object(l.a)(c.a.mark((function e(t){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.File&&window.FileReader&&window.FileList&&window.Blob){e.next=3;break}return alert("The File APIs are not fully supported in this browser."),e.abrupt("return");case 3:return ve(!0),n=t.target.files[0],e.next=7,n.arrayBuffer();case 7:i=e.sent,ve(!1),Le(i),window.confirm("Do you want to upload ".concat(n.name,"?"))&&F(Object(R.l)(a.slug));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bt=function(e,t){oe(t)},gt=function(){We(!0)},ht=function(){return We(!1)},pt=function(e){me(e.target.value)},mt=function(){Se(!1)},ft=function(){var t={title:ie,transcript:ee,description:Y,narrator:se.id,tags:De,imageURLs:je,languageCode:pe},a=R.b;e.id&&(t.id=e.id,a=R.s),F(a(t))},Ot=function(){var e=a.published?R.r:R.n;F(e(a.id))},xt=function(e){A||Ae(Object(i.a)(e.target.value))},vt={PaperProps:{style:{maxHeight:300,width:240}}};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(y.a,{onValid:function(){return _e(!0)},onInvalid:function(){return _e(!1)},children:Object(o.jsxs)("div",{className:B.container,children:[Object(o.jsxs)("div",{className:B.left,children:[Object(o.jsxs)("div",{className:B.imagesContainer,children:[je.map((function(e,t){return Object(o.jsx)(k,{imageURL:e,onDelete:ut(t),className:B.image},e)})),Object(o.jsx)(D,{onClick:ot})]}),Object(o.jsx)(V,{name:"description",className:B.description,label:"Description",validations:{minLength:10,maxLength:1e3},validationErrors:{minLength:"The description should have 10-1000 characters.",maxLength:"The description should have 10-1000 characters."},multiline:!0,rows:5,variant:"outlined",size:"small",value:Y,onChange:function(e){Z(e.target.value)},InputProps:{classes:{input:B.descriptionInput}},required:!0}),Object(o.jsx)(V,{name:"transcript",className:B.transcript,label:"Transcript",validations:{minLength:10,maxLength:2e4},validationErrors:{minLength:"The transcript should have 10-20000 characters.",maxLength:"The transcript should have 10-20000 characters."},multiline:!0,rows:30,variant:"outlined",size:"small",value:ee,onChange:function(e){te(e.target.value)},InputProps:{classes:{input:B.transcriptInput}},required:!0})]}),Object(o.jsxs)("div",{className:B.right,children:[Object(o.jsx)(V,{name:"title",className:B.title,label:"Title",validations:{minLength:10,maxLength:200},validationErrors:{minLength:"The title should have 10-200 characters.",maxLength:"The title should have 10-200 characters."},variant:"outlined",size:"small",value:ie,onChange:function(e){re(e.target.value)},required:!0}),Object(o.jsx)(w.a,{size:"small",filterOptions:rt,open:Ge,onOpen:gt,onClose:ht,renderOptionLabel:function(e){return Object(o.jsx)(d.a.Fragment,{children:"".concat(e.userName," \u2022 ").concat(e.firstName," ").concat(e.lastName)})},renderOption:function(e){return Object(o.jsxs)("div",{className:B.narratorOption,children:[Object(o.jsx)("img",{className:B.narratorImage,src:e.pictureURL}),Object(o.jsxs)("div",{className:B.narratorTexts,children:[Object(o.jsxs)("span",{className:B.narratorName,children:[e.firstName," ",e.lastName]}),Object(o.jsx)("span",{className:B.narratorUserName,children:e.userName})]})]})},className:B.narrator,options:Be,loading:ct,renderInput:function(e){return Object(o.jsx)(V,Object(n.a)(Object(n.a)({name:"narrator"},e),{},{label:"Narrator",variant:"outlined",InputProps:Object(n.a)(Object(n.a)({},e.InputProps),{},{endAdornment:Object(o.jsxs)(d.a.Fragment,{children:[ct?Object(o.jsx)(f.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}),onChange:function(e){return Xe(e.target.value)}}))},getOptionSelected:function(e,t){return e.id===t.id},getOptionLabel:function(e){return e.userName||"unavailable"},value:se,onChange:bt}),Object(o.jsxs)(j.a,{className:B.tags,variant:"outlined",size:"small",children:[Object(o.jsx)(b.a,{style:{backgroundColor:"white",paddingLeft:4,paddingRight:4},id:"tags-label",children:"Tags"}),Object(o.jsxs)(g.a,{labelId:"tags-label",multiple:!0,value:De,onChange:xt,renderValue:function(){return Object(o.jsx)("div",{className:B.chips,children:De.map((function(e){var t=P[e];return Object(o.jsx)(p.a,{label:t.title,className:B.chip,avatar:Object(o.jsx)(m.a,{src:t.imageURL})},e)}))})},MenuProps:vt,children:[0===E.length&&Object(o.jsx)("div",{className:B.loadingArticleTags,children:Object(o.jsx)(f.a,{size:"24px"})}),E.length>0&&E.map((function(e){return Object(o.jsxs)(h.a,{value:e.id,children:[Object(o.jsx)("img",{className:B.articleTagImage,src:e.imageURL}),Object(o.jsx)(O.a,{children:e.title})]},e.id)}))]})]}),Object(o.jsxs)(j.a,{variant:"outlined",className:B.languageCode,size:"small",required:!0,children:[Object(o.jsx)(b.a,{id:"languageCodeLabel",children:"Language"}),Object(o.jsx)(g.a,{labelId:"languageCodeLabel",value:pe,onChange:pt,label:"Language",children:J.map((function(e){return Object(o.jsx)(h.a,{value:e.locale,children:e.title},e.locale)}))})]}),Object(o.jsxs)(x.a,{type:"submit",variant:"contained",color:"primary",className:B.save,onClick:ft,disabled:!$e||!se||N,children:[N&&Object(o.jsx)(f.a,{size:16,className:B.progress}),"Save"]}),lt?Object(o.jsx)("audio",{controls:!0,className:B.audioPlayer,ref:q,onError:mt,children:Object(o.jsx)("source",{src:a.audioURL,type:"audio/wav"})}):null,function(){if(!lt)return null;var e=xe||S||I;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("input",{ref:et,type:"file",accept:"audio/*",multiple:!1,onChange:jt,onClick:dt,hidden:!0}),Object(o.jsxs)(x.a,{variant:"contained",color:"primary",className:B.attachAudio,onClick:function(){var e;return null===(e=et.current)||void 0===e?void 0:e.click()},disabled:e,children:[e&&Object(o.jsx)(f.a,{size:8,className:B.progress}),xe&&"Loading file...",S&&"Preparing to upload...",I&&"Uploading...",!e&&"Attach Audio"]})]})}(),lt&&Te&&je.length>0&&!st&&Object(o.jsx)(x.a,{variant:"contained",color:"primary",className:B.publish,onClick:Ot,children:a.published?"Unpublish":"Publish"})]})]})}),Ue&&Object(o.jsx)(W,{open:!0,onCancel:function(){ze(!1)},onResult:function(e){be([].concat(Object(i.a)(je),[e])),ze(!1)}})]})}}}]);
//# sourceMappingURL=1.ce503321.chunk.js.map